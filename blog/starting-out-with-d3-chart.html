<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="57x57" href="/isotype.png"/><link rel="apple-touch-icon" sizes="60x60" href="/isotype.png"/><link rel="apple-touch-icon" sizes="72x72" href="/isotype.png"/><link rel="apple-touch-icon" sizes="76x76" href="/isotype.png"/><link rel="apple-touch-icon" sizes="114x114" href="/isotype.png"/><link rel="apple-touch-icon" sizes="120x120" href="/isotype.png"/><link rel="apple-touch-icon" sizes="144x144" href="/isotype.png"/><link rel="apple-touch-icon" sizes="152x152" href="/isotype.png"/><link rel="apple-touch-icon" sizes="180x180" href="/isotype.png"/><link rel="icon" type="image/png" sizes="192x192" href="/isotype.png"/><link rel="icon" type="image/png" sizes="32x32" href="/isotype.png"/><link rel="icon" type="image/png" sizes="96x96" href="/isotype.png"/><link rel="icon" type="image/png" sizes="16x16" href="/isotype.png"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/isotype.png"/><meta name="theme-color" content="#ffffff"/><title>Starting out with d3.chart</title><link rel="preload" href="/new-profile/_next/static/css/8e1df1737e67450786cc.css" as="style"/><link rel="stylesheet" href="/new-profile/_next/static/css/8e1df1737e67450786cc.css" data-n-g=""/><link rel="preload" href="/new-profile/_next/static/css/bc9bbcd6fea02b72560a.css" as="style"/><link rel="stylesheet" href="/new-profile/_next/static/css/bc9bbcd6fea02b72560a.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/new-profile/_next/static/chunks/main-5ab6ea82c9087f336e12.js" as="script"/><link rel="preload" href="/new-profile/_next/static/chunks/webpack-38f4ef47162466e52626.js" as="script"/><link rel="preload" href="/new-profile/_next/static/chunks/framework.7008427c9ed7ea1ea070.js" as="script"/><link rel="preload" href="/new-profile/_next/static/chunks/1ca0266d.bc7564fa166f0d34b14f.js" as="script"/><link rel="preload" href="/new-profile/_next/static/chunks/commons.c903b9c5c3d275f65bfc.js" as="script"/><link rel="preload" href="/new-profile/_next/static/chunks/74dccfed65656dfb6adb258ae839e136f67e0276.47b8922ced02d1ddaa2f.js" as="script"/><link rel="preload" href="/new-profile/_next/static/chunks/2412aec2c30a40454afb28aa7ad51596c664a3e6.1e80e1ab8448746fa0db.js" as="script"/><link rel="preload" href="/new-profile/_next/static/chunks/pages/_app-f2c3a34a245e55351e50.js" as="script"/><link rel="preload" href="/new-profile/_next/static/chunks/57c9d6e4b97e6bcf244aee8ce3648d5d9adaacb1.bfcec4d669b9affd02e0.js" as="script"/><link rel="preload" href="/new-profile/_next/static/chunks/798fd9b41a459e61ee4594ce38d25c96f259064c.8c8bea5984a65dd9a41b.js" as="script"/><link rel="preload" href="/new-profile/_next/static/chunks/pages/blog/starting-out-with-d3-chart-3d82e4a2fff575c87ac1.js" as="script"/></head><body><div id="__next"><div class="flex flex-col min-h-screen font-sans text-base antialiased text-gray-800"><header class="px-6"><div class="pt-4 mx-auto max-w-7xl md:pt-6 xl:pt-8"><div class="flex justify-between pb-4 md:pb-0 md:border-b md:border-gray-200 md:justify-start"><a class="text-sm font-light tracking-wide uppercase md:text-base lg:text-xl" href="/"><span class="font-bold">Frank</span>Cary</a><button class="p-2 -m-2 text-gray-700 focus:outline-none md:hidden"><svg fill="currentColor" viewBox="0 0 20 20" class="block w-4 h-4"><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path></svg></button><div class="items-center hidden ml-auto md:flex"><a class="pb-4 ml-6 -mb-px text-gray-600 border-b border-transparent xl:pb-6 lg:ml-8 lg:text-base xl:text-lg hover:text-gray-900" href="/projects">Projects</a><a class="pb-4 ml-6 -mb-px text-gray-600 border-b border-transparent xl:pb-6 lg:ml-8 lg:text-base xl:text-lg hover:text-gray-900" href="/contact">Contact</a></div></div><div class="md:hidden"></div></div></header><main class="flex flex-col flex-1"><div class="px-6 pt-6 md:pt-12 lg:pt-16 md:leading-relaxed md:text-lg- lg:text-lg"><div class="max-w-measure mx-auto"><article><div class="mb-8 md:mb-10"><h1 class="mt-8 text-3xl font-semibold leading-tight md:text-4xl lg:text-4-5xl">Starting out with d3.chart</h1></div><p class="mt-4 lg:mt-6">Writing reusable D3 code can be tough. The community shines at providing one-off examples of really cool charts, but it&#x27;s hard to find a conventional approach to building out a small library of reusable components. <a class="text-blue-500 underline" href="http://misoproject.com/d3-chart/">d3.chart</a> is a library from Bocoup that aims to simplify the development of reusable D3 charts.</p><p class="mt-4 lg:mt-6">If you&#x27;re not familiar with d3.chart at all, <a class="text-blue-500 underline" href="https://github.com/misoproject/d3.chart/wiki/quickstart">this walkthrough</a> on Github is a great place to start. You should be able to go through it without too much trouble, but as always, the devil is in the details. In this post I&#x27;ll walk you through building a slightly more complex chart than what&#x27;s in the walkthrough. Hopefully it will save you some time as you learn the library.</p><p class="mt-4 lg:mt-6">Now, it wouldn&#x27;t make much sense to create an isolated chart with d3.chart; after all, the whole point is composability. So let&#x27;s start out by making a base chart, which we can then extend to make other visualizations.</p><h2 id="the-base-chart" class="pt-20 mt-8 text-lg font-semibold leading-tight text-gray-900 border-t border-gray-200 md:text-2xl">The base chart</h2><p class="mt-4 lg:mt-6">Most charts have a lot in common, like dealing with width and height or re-rendering on resize events. To share this functionality across all our charts, we&#x27;ll make a base chart superclass. @iros, one of the library&#x27;s authors, regularly updates a <a class="text-blue-500 underline" href="https://github.com/iros/d3.chart.base">base chart</a> on Github, which I use here as a starting point. (There&#x27;s a lot going on in that code - don&#x27;t worry about it for now.)</p><p class="mt-4 lg:mt-6">We start by defining our base chart:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BaseChart&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token" style="color:#5A6371;font-style:italic">// config options go here</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">Now let&#x27;s create some properties. For this example, we&#x27;ll add width, height, and margin properties to our base chart, since these are pretty common across all charts. In keeping with <a class="text-blue-500 underline" href="http://bl.ocks.org/mbostock/3019563">D3&#x27;s margin conventions</a>, we want all code in our extended charts to be able to ignore margins. This means the <code class="px-1 py-px text-sm bg-gray-100">width</code> and <code class="px-1 py-px text-sm bg-gray-100">height</code> properties will refer to the <em>inner</em> dimensions of our base chart. Our extended charts can then use these values for scales and other similar objects, without any knowledge of what the base chart&#x27;s margins are. Note that this is also how the box model and CSS work in the browser: the width of an element corresponds to the <em>inner</em> width.</p><p class="mt-4 lg:mt-6">We&#x27;ll create the properties in the <code class="px-1 py-px text-sm bg-gray-100">initialize</code> key of our chart&#x27;s configuration:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BaseChart&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">initialize</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#5A6371;font-style:italic">// set up properties with reasonable defaults</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span> top</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">20</span><span class="token" style="color:#A9B2C0">,</span><span> right</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">20</span><span class="token" style="color:#A9B2C0">,</span><span> bottom</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">20</span><span class="token" style="color:#A9B2C0">,</span><span> left</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">20</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_width</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;width&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>      </span><span class="token" style="color:#19B9C4">?</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;width&quot;</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#19B9C4">-</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">left</span><span> </span><span class="token" style="color:#19B9C4">-</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">right</span><span>
</span></span><span><span>      </span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">200</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_height</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;height&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>      </span><span class="token" style="color:#19B9C4">?</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;height&quot;</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#19B9C4">-</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">top</span><span> </span><span class="token" style="color:#19B9C4">-</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">bottom</span><span>
</span></span><span><span>      </span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">200</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">As indicated in <a class="text-blue-500 underline" href="http://misoproject.com/d3-chart/api.html#d3chart_i_base">the docs</a>, <code class="px-1 py-px text-sm bg-gray-100">this.base</code> refers to the <a class="text-blue-500 underline" href="https://github.com/mbostock/d3/wiki/Selections">D3 selection</a> our chart will operate on - typically an <code class="px-1 py-px text-sm bg-gray-100">&lt;svg&gt;</code> element. If the width and height have already been set on this selection, we&#x27;ll take those values for the dimensions of our charts; otherwise, we&#x27;ll choose default values of 200.</p><p class="mt-4 lg:mt-6">Next, we&#x27;ll append a <code class="px-1 py-px text-sm bg-gray-100">g</code> element to the base and translate it by our margins - again, by convention:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;BaseChart&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span>
</span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">initialize</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token spread" style="color:#19B9C4">...</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color:#5A6371;font-style:italic">// add a marginalized container</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;g&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>      </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;transform&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#8CC570">&#x27;translate(&#x27;</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">left</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#8CC570">&#x27;,&#x27;</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">top</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#8CC570">&#x27;)&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">We&#x27;ll render our extended charts to this element. Since the charts will reference the inner dimensions, they will implicitly recognize our base chart&#x27;s margins.</p><h2 id="gettersetters" class="pt-20 mt-8 text-lg font-semibold leading-tight text-gray-900 border-t border-gray-200 md:text-2xl">Getter/setters</h2><p class="mt-4 lg:mt-6">To make the dimensions accessible, we can write getter/setters. Let&#x27;s start with width:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;BaseChart&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">initialize</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span class="token spread" style="color:#19B9C4">...</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span>
</span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">width</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">newWidth</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">if</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span>arguments</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">length</span><span> </span><span class="token" style="color:#19B9C4">===</span><span> </span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>      </span><span class="token" style="color:#D373E3">return</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_width</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#A9B2C0">}</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color:#5A6371;font-style:italic">// only if the width actually changed,</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">if</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_width</span><span> </span><span class="token" style="color:#19B9C4">!==</span><span> newWidth</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span>
</span><span><span>      </span><span class="token" style="color:#D373E3">var</span><span> oldWidth </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_width</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>      </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_width</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> newWidth</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>      </span><span class="token" style="color:#5A6371;font-style:italic">// set higher container&#x27;s width</span><span>
</span></span><span><span>      </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;width&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_width</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">left</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">right</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>      </span><span class="token" style="color:#5A6371;font-style:italic">// trigger a change event</span><span>
</span></span><span><span>      </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">trigger</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;change:width&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> newWidth</span><span class="token" style="color:#A9B2C0">,</span><span> oldWidth</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#A9B2C0">}</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color:#5A6371;font-style:italic">// always return the chart, for chaining magic.</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">return</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">Notice that we trigger an event when the width changes, sending the new and old widths as event parameters. This allows our extended charts to, for example, render custom transitions during the change event.</p><p class="mt-4 lg:mt-6">The height method is nearly identical, and for now I&#x27;ve just made the margin method a barebones getter/setter. You can see them both in the links at the end of this post.</p><p class="mt-4 lg:mt-6">There&#x27;s one more item on the agenda before we can leave our base chart. In the <code class="px-1 py-px text-sm bg-gray-100">initialize</code> method, we provided some defaults for width and height, in case they were not defined on the parent container element. If in fact we do use those defaults, our base chart should go ahead and set the container&#x27;s actual dimensions in the DOM. The code is the same as what&#x27;s already in our getter/setters: <code class="px-1 py-px text-sm bg-gray-100">this.base.attr(&#x27;width&#x27;, this._width + this._margin.left + this._margin.right)</code>.</p><p class="mt-4 lg:mt-6">Since duplication is evil, let&#x27;s first wrap this up in a method instead of copying it, and then replace the code in the <code class="px-1 py-px text-sm bg-gray-100">width</code> method with a call to this new method:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;BaseChart&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">initialize</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span class="token spread" style="color:#19B9C4">...</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span>
</span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">updateContainerWidth</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;width&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_width</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">left</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">right</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span>
</span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">width</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">newWidth</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token spread" style="color:#19B9C4">...</span><span>
</span></span><span><span>    </span><span class="token" style="color:#5A6371;font-style:italic">// set higher container&#x27;s width</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">updateContainerWidth</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token spread" style="color:#19B9C4">...</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">We do the same for height. Now, let&#x27;s add code in the <code class="px-1 py-px text-sm bg-gray-100">initialize</code> method to make sure the parent container&#x27;s dimensions are set:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;BaseChart&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">initialize</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color:#5A6371;font-style:italic">// setup some reasonable defaults</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>top</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">20</span><span class="token" style="color:#A9B2C0">,</span><span> right</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">20</span><span class="token" style="color:#A9B2C0">,</span><span> bottom</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">20</span><span class="token" style="color:#A9B2C0">,</span><span> left</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">20</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_width</span><span>  </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;width&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#19B9C4">?</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;width&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#19B9C4">-</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">left</span><span> </span><span class="token" style="color:#19B9C4">-</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">right</span><span> </span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">200</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_height</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;height&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#19B9C4">?</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;height&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#19B9C4">-</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">top</span><span> </span><span class="token" style="color:#19B9C4">-</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">bottom</span><span> </span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">200</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color:#5A6371;font-style:italic">// make sure container height and width are set</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">updateContainerWidth</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">updateContainerHeight</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color:#5A6371;font-style:italic">// add a marginalized container</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;g&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;transform&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#8CC570">&#x27;translate(&#x27;</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">left</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#8CC570">&#x27;,&#x27;</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">_margin</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">top</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#8CC570">&#x27;)&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span>
</span><span><span>  </span><span class="token spread" style="color:#19B9C4">...</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">We now have a base chart that handles dimensions and margins - we&#x27;re ready to extend it!</p><h2 id="a-bar-chart" class="pt-20 mt-8 text-lg font-semibold leading-tight text-gray-900 border-t border-gray-200 md:text-2xl">A bar chart</h2><p class="mt-4 lg:mt-6">We&#x27;ll make a simple bar chart that extends our base chart:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BaseChart&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">extend</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BarChart&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token" style="color:#5A6371;font-style:italic">// config options</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">Just like in the base chart, we&#x27;ll put variables we plan on using throughout the chart in the <code class="px-1 py-px text-sm bg-gray-100">initialize</code> method, as properties. In this chart we&#x27;ll need x and y scales, and a color scale.</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BaseChart&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">extend</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BarChart&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">initialize</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">xScale</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">scale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">ordinal</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">rangeRoundBands</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">[</span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">width</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">0.1</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">yScale</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">scale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">linear</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">range</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">[</span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">height</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">color</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">scale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">category10</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">Notice that our extended bar chart has access to the width and height methods in the base chart (e.g. <code class="px-1 py-px text-sm bg-gray-100">this.height()</code>), just as we&#x27;d expect.</p><p class="mt-4 lg:mt-6">Next, let&#x27;s think about the events that our base chart triggers. How will a changing width or height affect our bar chart? Looking at the code we just added, we can see that the x and y scales depend on the chart&#x27;s dimensions. This means that when the width (height) changes, we need to update the range of the x (y) scale.</p><p class="mt-4 lg:mt-6">There are some methods provided by d3.chart for data-driven operations, but since this code doesn&#x27;t depend on the actual data our chart will be displaying, we can add it to the <code class="px-1 py-px text-sm bg-gray-100">initialize</code> method:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BaseChart&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">extend</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BarChart&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">initialize</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">var</span><span> chart </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>    chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">xScale</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">scale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">ordinal</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">rangeRoundBands</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">[</span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">,</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">width</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">0.1</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">yScale</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">scale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">linear</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">range</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">[</span><span>chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">height</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">color</span><span> </span><span class="token" style="color:#19B9C4">=</span><span> d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">scale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">category10</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color:#5A6371;font-style:italic">// update scales on dimension changes</span><span>
</span></span><span><span>    chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">on</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;change:width&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">newWidth</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>      chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">xScale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">rangeRoundBands</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">[</span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">,</span><span> newWidth</span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">0.1</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">on</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;change:height&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">newHeight</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>      chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">yScale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">range</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">[</span><span>newHeight</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><h2 id="transform" class="pt-20 mt-8 text-lg font-semibold leading-tight text-gray-900 border-t border-gray-200 md:text-2xl">Transform</h2><p class="mt-4 lg:mt-6">Layers in d3.chart are where we actually create our data-driven elements - in our case, the bars. But before we get there, we need to make sure our data is in the correct format. To find out if we need to first transform our data, lets ask ourselves the following:</p><ol class="pl-6 mt-4 list-decimal lg:mt-6"><li class="mt-2">Does our data need to be massaged before being bound to our elements?</li><li class="mt-2">Are there any one-time data-driven operations that need to be performed on a given input data set for the chart as a whole (i.e. data-driven operations that don&#x27;t belong in any particular layer)?</li></ol><p class="mt-4 lg:mt-6">If you have operations that fall into either of these categories, you should put them in the <code class="px-1 py-px text-sm bg-gray-100">transform</code> method. This method takes the raw data that the user passes in, transforms it, and then hands the transformed data off to the rest of your chart.</p><p class="mt-4 lg:mt-6">So what about us - do we need to perform any such operations? To answer the first question, let&#x27;s look at a sample of our raw data:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="token" style="color:#D373E3">var</span><span> data </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#A9B2C0">[</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">{</span><span>name</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#8CC570">&quot;A&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> value</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">10</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">{</span><span>name</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#8CC570">&quot;B&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> value</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">3</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span>  </span><span class="token spread" style="color:#19B9C4">...</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#19B9C4">:</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">In our case, the <code class="px-1 py-px text-sm bg-gray-100">value</code> data will be bound to our bars. There&#x27;s no transformation we need to perform, since we&#x27;ll just pass the data through our scales to get the appropriate heights. So, we don&#x27;t really need to massage the data for our layers.</p><p class="mt-4 lg:mt-6">But what about the second question? Our scales <em>do</em> change based on the extent of our data. Because the scales are characteristics of the chart as a whole, rather than just the bars layer (consider sharing the scales with an axis layer), let&#x27;s add code to update our scales in the <code class="px-1 py-px text-sm bg-gray-100">transform</code> method:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;BaseChart&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">extend</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;BarChart&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span>
</span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">initialize</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span>
</span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">transform</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">data</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">var</span><span> chart </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color:#5A6371;font-style:italic">// update the scales</span><span>
</span></span><span><span>    chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">xScale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">domain</span><span class="token" style="color:#A9B2C0">(</span><span>data</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">map</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">d</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span> </span><span class="token" style="color:#D373E3">return</span><span> d</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">name</span><span class="token" style="color:#A9B2C0">;</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">yScale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">domain</span><span class="token" style="color:#A9B2C0">(</span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">extent</span><span class="token" style="color:#A9B2C0">(</span><span>data</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">d</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span class="token" style="color:#D373E3">return</span><span> d</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">value</span><span class="token" style="color:#A9B2C0">;</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color:#D373E3">return</span><span> data</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">Note that we have to return <code class="px-1 py-px text-sm bg-gray-100">data</code>, even though we didn&#x27;t actually do anything to it, because d3.chart hands off the return value of this method to the rest of our chart.</p><h2 id="layers" class="pt-20 mt-8 text-lg font-semibold leading-tight text-gray-900 border-t border-gray-200 md:text-2xl">Layers</h2><p class="mt-4 lg:mt-6">Now we&#x27;re ready to add a layer, where we will actually render the bars. We add the layer in the <code class="px-1 py-px text-sm bg-gray-100">initialize</code> method. Layers take a name, a D3 selection, and an options object in their definition (<a class="text-blue-500 underline" href="http://misoproject.com/d3-chart/api.html#d3chart_i_layer">docs</a>):</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;BaseChart&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">extend</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;BarChart&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span>
</span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">initialize</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token spread" style="color:#19B9C4">...</span><span>
</span></span><span>
</span><span><span>    chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">layer</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;bars&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">select</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;g&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;g&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">classed</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;bars&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span class="token" style="color:#DB975C">true</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>      </span><span class="token" style="color:#5A6371;font-style:italic">// layer options</span><span>
</span></span><span><span>    </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span>
</span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">transform</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">data</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span class="token spread" style="color:#19B9C4">...</span><span class="token" style="color:#A9B2C0">}</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">Our bars layer gets its own <code class="px-1 py-px text-sm bg-gray-100">g</code> element. This element is a child of the base chart&#x27;s <code class="px-1 py-px text-sm bg-gray-100">g</code> element, so that we can ignore margins while coding our bar chart.</p><p class="mt-4 lg:mt-6">Now, let&#x27;s flesh out the layer. Typically in D3, we use the following workflow:</p><ol class="pl-6 mt-4 list-decimal lg:mt-6"><li class="mt-2">Bind data to elements</li><li class="mt-2">Insert those elements to the DOM</li><li class="mt-2">Transform those elements when the data changes</li></ol><p class="mt-4 lg:mt-6">d3.chart preserves this workflow, but forces us to keep these concerns separate. We&#x27;ll start out by binding our data within the <code class="px-1 py-px text-sm bg-gray-100">dataBind</code> method:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">layer</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;bars&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">select</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;g&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;g&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">classed</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;bars&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">true</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">dataBind</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">data</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">return</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">selectAll</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;.bar&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">data</span><span class="token" style="color:#A9B2C0">(</span><span>data</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">This gives us a data join to work with. Next, we use the <code class="px-1 py-px text-sm bg-gray-100">insert</code> method to insert the elements into the DOM:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">layer</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;bars&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">select</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;g&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;g&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">classed</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;bars&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span class="token" style="color:#DB975C">true</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">dataBind</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">data</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span class="token spread" style="color:#19B9C4">...</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span>
</span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">insert</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">return</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;rect&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>      </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;class&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#8CC570">&#x27;bar&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">In both of these methods we return the selections, so our subsequent handlers can use them.</p><p class="mt-4 lg:mt-6">Finally, now that we have the elements in the DOM, we can manipulate them based on our data joins. D3 groups joins into enter, exit, update and merge subselections. d3.chart gives us access to each of these selections in an <code class="px-1 py-px text-sm bg-gray-100">events</code> hash within our layer. Within d3.chart, these events are referred to as <em>lifecycle events</em>.</p><p class="mt-4 lg:mt-6">Let&#x27;s code the <em>enter</em> lifecycle event. When new data enters our document, we&#x27;ll size the bars according to their values:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">layer</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;bars&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">base</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">select</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;g&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;g&#x27;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">classed</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;bars&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span class="token" style="color:#DB975C">true</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">dataBind</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">data</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span class="token spread" style="color:#19B9C4">...</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">insert</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span class="token spread" style="color:#19B9C4">...</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span>
</span><span><span>  events</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#8CC570">&#x27;enter&#x27;</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>      </span><span class="token" style="color:#D373E3">var</span><span> chart </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>      </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;x&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">d</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span> </span><span class="token" style="color:#D373E3">return</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">xScale</span><span class="token" style="color:#A9B2C0">(</span><span>d</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">name</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>        </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;y&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">d</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span> </span><span class="token" style="color:#D373E3">return</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">yScale</span><span class="token" style="color:#A9B2C0">(</span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">max</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">[</span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">,</span><span> d</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">value</span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>        </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;fill&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">d</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span class="token" style="color:#D373E3">return</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">color</span><span class="token" style="color:#A9B2C0">(</span><span>d</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">name</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>        </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;width&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">xScale</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">rangeBand</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>        </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;height&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">d</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span> </span><span class="token" style="color:#D373E3">return</span><span> </span><span class="token known-class-name" style="color:#ECBE70">Math</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">abs</span><span class="token" style="color:#A9B2C0">(</span><span>chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">yScale</span><span class="token" style="color:#A9B2C0">(</span><span>d</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">value</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#19B9C4">-</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">yScale</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#A9B2C0">}</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">At this point you may be wondering why we <code class="px-1 py-px text-sm bg-gray-100">append</code>ed the elements in the <code class="px-1 py-px text-sm bg-gray-100">insert</code> method, rather than in the <code class="px-1 py-px text-sm bg-gray-100">enter</code> selection, like <a class="text-blue-500 underline" href="http://d3js.org/#enter-exit">we&#x27;re used to seeing in standard D3 code</a>:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">select</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;body&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">selectAll</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;p&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">data</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">[</span><span class="token" style="color:#DB975C">4</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">8</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">15</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">16</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">23</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#DB975C">42</span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">enter</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;p&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">text</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#D373E3">function</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">d</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">return</span><span> </span><span class="token" style="color:#8CC570">&quot;Im number &quot;</span><span> </span><span class="token" style="color:#19B9C4">+</span><span> d </span><span class="token" style="color:#19B9C4">+</span><span> </span><span class="token" style="color:#8CC570">&quot;!&quot;</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">The reason we append elements in the <code class="px-1 py-px text-sm bg-gray-100">insert</code> method and not in the <code class="px-1 py-px text-sm bg-gray-100">enter</code> selection is for extensibility. d3.chart allows others to add code to our existing charts. One of they ways they can do this is by writing their own handlers to our chart&#x27;s <code class="px-1 py-px text-sm bg-gray-100">enter</code> event. Because of this, we want to ensure that when they write their handler, they are referencing the same D3 selection; in essence, that <code class="px-1 py-px text-sm bg-gray-100">this</code> refers to the same thing in their code as it does in ours. In D3, when we <code class="px-1 py-px text-sm bg-gray-100">append</code> elements, we actually change the selection.</p><p class="mt-4 lg:mt-6">Thus, by keeping our <code class="px-1 py-px text-sm bg-gray-100">append</code> operations in <code class="px-1 py-px text-sm bg-gray-100">insert</code>, and doing all other data-driven transformations on the <code class="px-1 py-px text-sm bg-gray-100">enter</code> selection within the events hash, <code class="px-1 py-px text-sm bg-gray-100">this</code> will always refer to the <code class="px-1 py-px text-sm bg-gray-100">enter</code> selection, for any developer who works on our chart.</p><p class="mt-4 lg:mt-6">At this point, we have a working bar chart! Let&#x27;s give it a spin.</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="token" style="color:#D373E3">var</span><span> data </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#A9B2C0">[</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">{</span><span> name</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#8CC570">&quot;A&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> value</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">4</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">{</span><span> name</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#8CC570">&quot;B&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> value</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#19B9C4">-</span><span class="token" style="color:#DB975C">36</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">{</span><span> name</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#8CC570">&quot;C&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> value</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">19</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">{</span><span> name</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#8CC570">&quot;D&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> value</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#19B9C4">-</span><span class="token" style="color:#DB975C">2</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">{</span><span> name</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#8CC570">&quot;E&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> value</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#DB975C">6</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color:#D373E3">var</span><span> barChart </span><span class="token" style="color:#19B9C4">=</span><span> d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">select</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;#bar-chart&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;svg&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BarChart&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>barChart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">draw</span><span class="token" style="color:#A9B2C0">(</span><span>data</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><div id="bar-chart"></div><p class="mt-4 lg:mt-6">Cool! Inspect the chart to see how the margins and layers work.</p><p class="mt-4 lg:mt-6">Let&#x27;s try out our width accessor:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="token" style="color:#D373E3">var</span><span> barChart </span><span class="token" style="color:#19B9C4">=</span><span> d3
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">select</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;#wide-bar-chart&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;svg&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BarChart&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">width</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#DB975C">500</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><div id="wide-bar-chart"></div><h2 id="transitions" class="pt-20 mt-8 text-lg font-semibold leading-tight text-gray-900 border-t border-gray-200 md:text-2xl">Transitions</h2><p class="mt-4 lg:mt-6">Working with transitions is quite easy, because transitions are lifecycle events just like the <code class="px-1 py-px text-sm bg-gray-100">enter</code> event. You can access a transition event by adding <code class="px-1 py-px text-sm bg-gray-100">:transition</code> to any of the four standard lifecycle events.</p><p class="mt-4 lg:mt-6">Let&#x27;s make our bars grow when they enter. First, we&#x27;ll change the <code class="px-1 py-px text-sm bg-gray-100">enter</code> lifecycle event, because when they are first drawn, the bars should start out on the x-axis with a height of 0:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-diff subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-diff" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="token unchanged token prefix unchanged"> </span><span class="token unchanged token line"> &#x27;enter&#x27;: function() {
</span></span><span><span class="token unchanged token line"></span><span class="token unchanged token prefix unchanged"> </span><span class="token unchanged token line">   var chart = this.chart();
</span></span><span><span class="token unchanged token line"></span><span>
</span></span><span><span></span><span class="token unchanged token prefix unchanged"> </span><span class="token unchanged token line">   this.attr(&#x27;x&#x27;, function(d) { return chart.xScale(d.name); })
</span></span><span><span class="token unchanged token line"></span><span class="token deleted-sign token prefix" style="color:#f92672">-</span><span class="token deleted-sign token line" style="color:#f92672">     .attr(&#x27;y&#x27;, function(d) { return chart.yScale(d3.max([0, d.value])); })
</span></span><span><span class="token deleted-sign token line" style="color:#f92672"></span><span class="token inserted-sign token prefix" style="color:#8CC570">+</span><span class="token inserted-sign token line" style="color:#8CC570">     .attr(&#x27;y&#x27;, function(d) { return chart.yScale(0); })
</span></span><span><span class="token inserted-sign token line" style="color:#8CC570"></span><span class="token unchanged token prefix unchanged"> </span><span class="token unchanged token line">     .attr(&#x27;fill&#x27;, function(d) {return chart.color(d.name);})
</span></span><span><span class="token unchanged token line"></span><span class="token unchanged token prefix unchanged"> </span><span class="token unchanged token line">     .attr(&#x27;width&#x27;, chart.xScale.rangeBand())
</span></span><span><span class="token unchanged token line"></span><span class="token deleted-sign token prefix" style="color:#f92672">-</span><span class="token deleted-sign token line" style="color:#f92672">     .attr(&#x27;height&#x27;, function(d) { return Math.abs(chart.yScale(d.value) - chart.yScale(0)); });
</span></span><span><span class="token deleted-sign token line" style="color:#f92672"></span><span class="token inserted-sign token prefix" style="color:#8CC570">+</span><span class="token inserted-sign token line" style="color:#8CC570">     .attr(&#x27;height&#x27;, 0);
</span></span><span><span class="token inserted-sign token line" style="color:#8CC570"></span><span class="token unchanged token prefix unchanged"> </span><span class="token unchanged token line"> },</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">Now, we&#x27;ll make them grow in the <code class="px-1 py-px text-sm bg-gray-100">enter:transition</code> event. We need to animate both the <code class="px-1 py-px text-sm bg-gray-100">y</code> value and the bar&#x27;s <code class="px-1 py-px text-sm bg-gray-100">height</code>:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>  </span><span class="token" style="color:#8CC570">&#x27;enter:transition&#x27;</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">var</span><span> chart </span><span class="token" style="color:#19B9C4">=</span><span> </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">duration</span><span class="token" style="color:#A9B2C0">(</span><span>chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">duration</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>      </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;y&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">d</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span> </span><span class="token" style="color:#D373E3">return</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">yScale</span><span class="token" style="color:#A9B2C0">(</span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">max</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">[</span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">,</span><span> d</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">value</span><span class="token" style="color:#A9B2C0">]</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>      </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">attr</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&#x27;height&#x27;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">d</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span> </span><span class="token" style="color:#D373E3">return</span><span> </span><span class="token known-class-name" style="color:#ECBE70">Math</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">abs</span><span class="token" style="color:#A9B2C0">(</span><span>chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">yScale</span><span class="token" style="color:#A9B2C0">(</span><span>d</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">value</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#19B9C4">-</span><span> chart</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">yScale</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#DB975C">0</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span> </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span></span></code></pre></div></div><p class="mt-4 lg:mt-6">All set! Let&#x27;s try it out.</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span class="token" style="color:#D373E3">var</span><span> barChart </span><span class="token" style="color:#19B9C4">=</span><span> d3
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">select</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;#animated-bar-chart&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">append</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;svg&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;BarChart&quot;</span><span class="token" style="color:#A9B2C0">)</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">width</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#DB975C">500</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><p class="mt-4 lg:mt-6"><a class="text-blue-500 underline" id="draw-animated-bar-chart">Click to run</a></p><div id="animated-bar-chart"></div><h2 id="conclusion" class="pt-20 mt-8 text-lg font-semibold leading-tight text-gray-900 border-t border-gray-200 md:text-2xl">Conclusion</h2><p class="mt-4 lg:mt-6">We&#x27;ve seen that d3.chart helps us build robust, reusable code. We were able to abstract common traits like widths and margins into our base chart, and extend it into a bar chart that&#x27;s wide open for customization.</p><p class="mt-4 lg:mt-6">d3.chart also helps us separate our D3 code into logical chunks - but what&#x27;s really cool is how this aspect carries over as we (or even other developers) extend our charts. For example, say we wanted to use the bar chart from this post, but we needed bars with negative values to be colored red. When using charting libraries, you&#x27;ll often run into situations like this: you&#x27;re able to work the configuration options 95% of the way, but you always seem to fall one option short of getting the exact chart you need.</p><p class="mt-4 lg:mt-6">Fortunately, with d3.chart, this isn&#x27;t an issue - just add the code yourself:</p><div><div class="my-8 -mx-6 overflow-hidden sm:rounded-lg md:mx-auto"><pre class="language-js subpixel-antialiased leading-relaxed text-sm- md:text-sm px-6 py-4 overflow-auto scrolling-touch" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#282c34"><code class="language-js" style="color:#A9B2C0;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span><span>d3</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">chart</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;AnimatedBarChart&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">extend</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;ProfitLossBarChart&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>  </span><span class="token function-variable" style="color:#40B1F5">initialize</span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#D373E3">function</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>    </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">layer</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;bars&quot;</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">on</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;enter&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>      </span><span class="token" style="color:#D373E3">this</span><span class="token" style="color:#A9B2C0">.</span><span class="token method" style="color:#40B1F5">style</span><span class="token" style="color:#A9B2C0">(</span><span class="token" style="color:#8CC570">&quot;fill&quot;</span><span class="token" style="color:#A9B2C0">,</span><span> </span><span class="token" style="color:#D373E3">function</span><span> </span><span class="token" style="color:#A9B2C0">(</span><span class="token parameter">d</span><span class="token parameter token" style="color:#A9B2C0">,</span><span class="token parameter"> i</span><span class="token" style="color:#A9B2C0">)</span><span> </span><span class="token" style="color:#A9B2C0">{</span><span>
</span></span><span><span>        </span><span class="token" style="color:#D373E3">return</span><span> d</span><span class="token" style="color:#A9B2C0">.</span><span class="token" style="color:#40B1F5">value</span><span> </span><span class="token" style="color:#19B9C4">&lt;</span><span> </span><span class="token" style="color:#DB975C">0</span><span> </span><span class="token" style="color:#19B9C4">?</span><span> </span><span class="token" style="color:#8CC570">&quot;red&quot;</span><span> </span><span class="token" style="color:#19B9C4">:</span><span> </span><span class="token" style="color:#8CC570">&quot;blue&quot;</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>      </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>    </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span><span>
</span></span><span><span>  </span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">,</span><span>
</span></span><span><span></span><span class="token" style="color:#A9B2C0">}</span><span class="token" style="color:#A9B2C0">)</span><span class="token" style="color:#A9B2C0">;</span></span></code></pre></div></div><div id="profit-loss-bar-chart"></div><p class="mt-4 lg:mt-6">Suffice it to say, d3.chart provides a very good solution to the perennial problem of chart configuration. I encourage you to try it out, and remember to <a class="text-blue-500 underline" href="http://misoproject.com/d3-chart/charts.html">show off your work on d3.chart&#x27;s website</a>!</p></article><p class="pt-8 text-sm font-medium text-right text-gray-500 md:mt-1">December 18, 2013</p><hr class="mt-10"/><div class="mt-10"><div><a class="block w-16 h-16 mx-auto overflow-hidden rounded-full" href="/"><div style="max-width:100%;width:985px"><div style="position:relative;padding-bottom:100%"><img data-src="/_next/image?url=%2Fimages%2Fprofile.jpeg&amp;w=1024&amp;q=75" data-srcset="/_next/image?url=%2Fimages%2Fprofile.jpeg&amp;w=320&amp;q=75 320w, /_next/image?url=%2Fimages%2Fprofile.jpeg&amp;w=420&amp;q=75 420w, /_next/image?url=%2Fimages%2Fprofile.jpeg&amp;w=768&amp;q=75 768w, /_next/image?url=%2Fimages%2Fprofile.jpeg&amp;w=1024&amp;q=75 1024w" class="__lazy" style="visibility:hidden;height:100%;left:0;position:absolute;top:0;width:100%"/></div></div></a></div><div class="mt-2 leading-none text-center"><p class="pt-2 text-xs font-semibold tracking-wider text-gray-600 uppercase">Written by</p><p class="pt-2 text-xl font-semibold"><a href="/">Sam Selikoff</a></p></div></div><div class="pb-24 mt-8 text-center"><a class="font-medium text-blue-500" href="/blog"> View all posts</a></div></div></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/blog/starting-out-with-d3-chart","query":{},"buildId":"zbyK13MpD2YQuzrXNB5Rb","assetPrefix":"/new-profile","nextExport":true,"autoExport":true,"isFallback":false,"head":[["meta",{"name":"viewport","content":"width=device-width"}],["meta",{"charSet":"utf-8"}],["link",{"rel":"apple-touch-icon","sizes":"57x57","href":"/isotype.png"}],["link",{"rel":"apple-touch-icon","sizes":"60x60","href":"/isotype.png"}],["link",{"rel":"apple-touch-icon","sizes":"72x72","href":"/isotype.png"}],["link",{"rel":"apple-touch-icon","sizes":"76x76","href":"/isotype.png"}],["link",{"rel":"apple-touch-icon","sizes":"114x114","href":"/isotype.png"}],["link",{"rel":"apple-touch-icon","sizes":"120x120","href":"/isotype.png"}],["link",{"rel":"apple-touch-icon","sizes":"144x144","href":"/isotype.png"}],["link",{"rel":"apple-touch-icon","sizes":"152x152","href":"/isotype.png"}],["link",{"rel":"apple-touch-icon","sizes":"180x180","href":"/isotype.png"}],["link",{"rel":"icon","type":"image/png","sizes":"192x192","href":"/isotype.png"}],["link",{"rel":"icon","type":"image/png","sizes":"32x32","href":"/isotype.png"}],["link",{"rel":"icon","type":"image/png","sizes":"96x96","href":"/isotype.png"}],["link",{"rel":"icon","type":"image/png","sizes":"16x16","href":"/isotype.png"}],["link",{"rel":"manifest","href":"/manifest.json"}],["meta",{"name":"msapplication-TileColor","content":"#ffffff"}],["meta",{"name":"msapplication-TileImage","content":"/isotype.png"}],["meta",{"name":"theme-color","content":"#ffffff"}],["title",{"children":"Starting out with d3.chart"}]]}</script><script nomodule="" src="/new-profile/_next/static/chunks/polyfills-f9ac226678fc858257de.js"></script><script src="/new-profile/_next/static/chunks/main-5ab6ea82c9087f336e12.js" async=""></script><script src="/new-profile/_next/static/chunks/webpack-38f4ef47162466e52626.js" async=""></script><script src="/new-profile/_next/static/chunks/framework.7008427c9ed7ea1ea070.js" async=""></script><script src="/new-profile/_next/static/chunks/1ca0266d.bc7564fa166f0d34b14f.js" async=""></script><script src="/new-profile/_next/static/chunks/commons.c903b9c5c3d275f65bfc.js" async=""></script><script src="/new-profile/_next/static/chunks/74dccfed65656dfb6adb258ae839e136f67e0276.47b8922ced02d1ddaa2f.js" async=""></script><script src="/new-profile/_next/static/chunks/2412aec2c30a40454afb28aa7ad51596c664a3e6.1e80e1ab8448746fa0db.js" async=""></script><script src="/new-profile/_next/static/chunks/pages/_app-f2c3a34a245e55351e50.js" async=""></script><script src="/new-profile/_next/static/chunks/57c9d6e4b97e6bcf244aee8ce3648d5d9adaacb1.bfcec4d669b9affd02e0.js" async=""></script><script src="/new-profile/_next/static/chunks/798fd9b41a459e61ee4594ce38d25c96f259064c.8c8bea5984a65dd9a41b.js" async=""></script><script src="/new-profile/_next/static/chunks/pages/blog/starting-out-with-d3-chart-3d82e4a2fff575c87ac1.js" async=""></script><script src="/new-profile/_next/static/zbyK13MpD2YQuzrXNB5Rb/_buildManifest.js" async=""></script><script src="/new-profile/_next/static/zbyK13MpD2YQuzrXNB5Rb/_ssgManifest.js" async=""></script></body></html>